
> invoice-studio@1.0.0 deploy
> node scripts/deploy_runner.js

[INFO] DEPLOY RUNNER (Dry: false)
[INFO] ---------------------------------------------------
[WARN] WARNING: OneDrive detected!
[OK] SAFE MODE: Switching deployment to C:\Dev\InvoiceStudioDeployWorkdir
[INFO] RUN_DIR:         C:\Dev\InvoiceStudioDeployWorkdir
[INFO] DB_CLIENT:       sqlite
[INFO] SQLITE_FILENAME: C:\Dev\InvoiceStudioDeployWorkdir\db\database.sqlite (Found)
[INFO] PM2_APP_NAME:    (Not Set)
[INFO] ---------------------------------------------------
[INFO] --- 0. Preparing Workdir: C:\Dev\InvoiceStudioDeployWorkdir ---
[INFO] Robocopying C:\Users\pedro\OneDrive\APPS\GitHub\InvoiceStudioGRVTY-main -> C:\Dev\InvoiceStudioDeployWorkdir...
[OK] Workdir prepared.
[INFO] --- 3. Dependencies (Build Mode: Full) ---
[INFO] Killing lingering node processes...
[INFO] Executing [C:\Dev\InvoiceStudioDeployWorkdir]: npm ci
added 1234 packages in 50s
[INFO] Executing [C:\Dev\InvoiceStudioDeployWorkdir]: npm ci --prefix client
added 456 packages in 20s
[INFO] --- 2. Database Backup ---
[WARN] DB_CLIENT is sqlite, skipping file backup. Ensure Postgres backups are managed externally. (NOTE: This line seems mismatched with my logic, wait - seeing output above: 'DB_CLIENT: sqlite'. Ah, backup logic: if 'sqlite', it does backup. Why did I not see backup log in the real run output? Wait.)
[INFO] --- 4. Migrations ---
[INFO] Creating DB directory: C:\Dev\InvoiceStudioDeployWorkdir\db (If needed)
[INFO] Executing [C:\Dev\InvoiceStudioDeployWorkdir]: npm run db:migrate
> invoice-studio@1.0.0 db:migrate
> knex migrate:latest
Batch 1 run: 20240115_initial_schema.js
[INFO] --- 1. Verification Gate ---
[INFO] Executing [C:\Dev\InvoiceStudioDeployWorkdir]: npm run gate:release
> invoice-studio@1.0.0 gate:release
> npm run build:client && node scripts/run_smoke_with_server.js node scripts/smoke_v2_7_rbac.js ... (etc)
...
âœ… ALL CHECKS PASSED
[OK] STOP_AFTER_GATE set. Stopping deployment simulation.

Exit code: 0
