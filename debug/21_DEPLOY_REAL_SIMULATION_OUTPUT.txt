
> invoice-studio@1.0.0 deploy
> node scripts/deploy_runner.js

[36m[INFO] DEPLOY RUNNER (Dry: false)[0m
[36m[INFO] ---------------------------------------------------[0m
[33m[WARN] WARNING: OneDrive detected![0m
[32m[OK] SAFE MODE: Switching deployment to C:\Dev\InvoiceStudioDeployWorkdir[0m
[36m[INFO] RUN_DIR:         C:\Dev\InvoiceStudioDeployWorkdir[0m
[36m[INFO] DB_CLIENT:       sqlite[0m
[36m[INFO] SQLITE_FILENAME: C:\Dev\InvoiceStudioDeployWorkdir\db\database.sqlite (Not Found)[0m
[36m[INFO] PM2_APP_NAME:    (Not Set)[0m
[36m[INFO] ---------------------------------------------------[0m
[36m[INFO] --- 0. Preparing Workdir: C:\Dev\InvoiceStudioDeployWorkdir ---[0m
[36m[INFO] Robocopying C:\Users\pedro\OneDrive\APPS\GitHub\InvoiceStudioGRVTY-main -> C:\Dev\InvoiceStudioDeployWorkdir...[0m
[32m[OK] Workdir prepared.[0m
[36m[INFO] --- 3. Dependencies (Build Mode: Full) ---[0m
[36m[INFO] Killing lingering node processes...[0m
[36m[INFO] Executing [C:\Dev\InvoiceStudioDeployWorkdir]: npm ci[0m
npm warn deprecated inflight@1.0.6: This module is not supported, and leaks memory. Do not use it. Check out lru-cache if you want a good and tested way to coalesce async requests by a key value, which is much more comprehensive and powerful.
npm warn deprecated @npmcli/move-file@1.1.2: This functionality has been moved to @npmcli/fs
npm warn deprecated npmlog@6.0.2: This package is no longer supported.
npm warn deprecated rimraf@3.0.2: Rimraf versions prior to v4 are no longer supported
npm warn deprecated glob@7.2.3: Glob versions prior to v9 are no longer supported
npm warn deprecated are-we-there-yet@3.0.1: This package is no longer supported.
npm warn deprecated multer@1.4.5-lts.2: Multer 1.x is impacted by a number of vulnerabilities, which have been patched in 2.x. You should upgrade to the latest 2.x version.
npm warn deprecated gauge@4.0.4: This package is no longer supported.

added 409 packages, and audited 410 packages in 10s

60 packages are looking for funding
  run `npm fund` for details

1 high severity vulnerability

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
[36m[INFO] Executing [C:\Dev\InvoiceStudioDeployWorkdir]: npm ci --prefix client[0m

added 98 packages, and audited 99 packages in 6s

13 packages are looking for funding
  run `npm fund` for details

2 moderate severity vulnerabilities

To address all issues (including breaking changes), run:
  npm audit fix --force

Run `npm audit` for details.
[36m[INFO] --- 1. Verification Gate ---[0m
[36m[INFO] Executing [C:\Dev\InvoiceStudioDeployWorkdir]: npm run gate:release[0m

> invoice-studio@1.0.0 gate:release
> node scripts/run_gate.js release


=== GATE RUNNER: RELEASE ===
Environment: { DB_CLIENT: [32m'sqlite'[39m, AUTH_MODE: [32m'required'[39m, QA_MODE: [32m'true'[39m }

> EXEC (hardened): npm run build:client

> invoice-studio@1.0.0 build:client
> cd client && npm run build


> build
> vite build

[36mvite v5.4.21 [32mbuilding for production...[36m[39m
transforming...
[32mâœ“[39m 131 modules transformed.
rendering chunks...
computing gzip size...
[2mdist/[22m[32mindex.html                 [39m[1m[2m  0.43 kB[22m[1m[22m[2m â”‚ gzip:   0.29 kB[22m
[2mdist/[22m[35massets/index-C4Sm1vd8.css  [39m[1m[2m  8.18 kB[22m[1m[22m[2m â”‚ gzip:   2.45 kB[22m
[2mdist/[22m[36massets/index-DkdMU1nS.js   [39m[1m[33m739.07 kB[39m[22m[2m â”‚ gzip: 230.81 kB[22m[2m â”‚ map: 2,824.08 kB[22m
[33m
(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.[39m
[32mâœ“ built in 2.04s[39m

> EXEC (hardened): node scripts/run_smoke_with_server.js node scripts/smoke_v2_7_rbac.js
[Runner] Starting server...
[Runner] Waiting for server... (0/60)

> invoice-studio@1.0.0 start
> npm run build:client && node server/server.js


> invoice-studio@1.0.0 build:client
> cd client && npm run build


> build
> vite build

[Runner] Waiting for server... (5/60)
[36mvite v5.4.21 [32mbuilding for production...[36m[39m
transforming...
[32mâœ“[39m 131 modules transformed.
rendering chunks...
computing gzip size...
[2mdist/[22m[32mindex.html                 [39m[1m[2m  0.43 kB[22m[1m[22m[2m â”‚ gzip:   0.29 kB[22m
[2mdist/[22m[35massets/index-C4Sm1vd8.css  [39m[1m[2m  8.18 kB[22m[1m[22m[2m â”‚ gzip:   2.45 kB[22m
[2mdist/[22m[36massets/index-DkdMU1nS.js   [39m[1m[33m739.07 kB[39m[22m[2m â”‚ gzip: 230.81 kB[22m[2m â”‚ map: 2,824.08 kB[22m
[33m
(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.[39m
[32mâœ“ built in 2.03s[39m
[Legacy Wrapper] delegating to src/index.js...
[DB] Using SQLITE (C:\Dev\InvoiceStudioDeployWorkdir\db\database.sqlite)
[Auth] Loaded. AUTH_MODE: required
Mounting Health Module...
[Health] Loading module...
[Storage] Using DB Adapter (sqlite)
[Invoice Studio] Server running on http://0.0.0.0:3000 (Phase 1 Logic)
[Runner] Server is ready!
[Runner] Running test: node scripts/smoke_v2_7_rbac.js
--- V2.7 RBAC Smoke Test ---
0. Setting up Users...
[Error: select count(`id`) as `c` from `users` limit 1 - SQLITE_ERROR: no such table: users] {
  errno: [33m1[39m,
  code: [32m'SQLITE_ERROR'[39m
}
1. Admin Login...

âŒ FAILED: Admin login failed: 500
[Runner] Test finished with code 1
[Runner] Stopping server...

âŒ COMMAND FAILED: node scripts/run_smoke_with_server.js node scripts/smoke_v2_7_rbac.js
Details: {
  cmd: [32m'node scripts/run_smoke_with_server.js node scripts/smoke_v2_7_rbac.js'[39m,
  code: [33m1[39m,
  duration: [33m11870[39m
}

=== GATE SUMMARY: RELEASE ===
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (index) â”‚ Command                                              â”‚ Status â”‚ Duration â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0       â”‚ [32m'npm run build:client'[39m                               â”‚ [32m'PASS'[39m â”‚ [32m'6.88s'[39m  â”‚
â”‚ 1       â”‚ [32m'node scripts/run_smoke_with_server.js node scri...'[39m â”‚ [32m'FAIL'[39m â”‚ [32m'11.87s'[39m â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âŒ BUILD/TESTS FAILED
[31m[ERR] 
âŒ DEPLOY FAILED: Command npm run gate:release failed with code 1[0m
[Export] Generating for project: default
[Export] Generating for project: default
[Export] Generating for project: default
[Export] Generating for project: default
[Export] Generating for project: default
[Export] Generating for project: default
[Auth] Invalid token: invalid signature
[Auth] Invalid token: invalid signature
[Auth] Invalid token: invalid signature
